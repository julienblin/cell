server {
  listen <%= @resource.port %>;
  server_name <%= @resource.server_name.is_a?(Array) ? @resource.server_name.join(' ') : @resource.server_name %>;
  <% if @resource.ssl %>
  ssl on;
  ssl_certificate <%= @resource.ssl_certificate %>;
  ssl_certificate_key <%= @resource.ssl_certificate_key %>;
  <% end %>
  
  location / {
	  root <%= @resource.static_files["root"] %>;
	  proxy_set_header X-Real-IP $remote_addr;
	  proxy_set_header Host $host;
	  proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	  
	  if (-f $request_filename) {
		  expires max;
		  access_log off;
		  break;
	  }
	  
	  if (!-f $request_filename) {
		  proxy_pass http://localhost:<%= @resource.application_port %>;
	  }
  }
}
